name: Doppler Secrets Demo

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  demo-secrets:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      
      - name: Verify Secret is Available
        run: |
          echo "Checking if API_KEY secret exists..."
          if [ -n "${{ secrets.API_KEY }}" ]; then
            echo "✓ API_KEY is available and has a value"
            echo "  Length: ${#SECRET_VALUE} characters"
          else
            echo "✗ API_KEY is not available"
          fi
        env:
          SECRET_VALUE: ${{ secrets.API_KEY }}
      
      - name: Show Partial Secret (Safe Demo)
        run: |
          echo "=== Safe Secret Display (First 4 characters only) ==="
          SECRET_PREVIEW="${SECRET_VALUE:0:4}..."
          echo "API_KEY starts with: $SECRET_PREVIEW"
          echo ""
          echo "This proves the secret is accessible without exposing it fully"
        env:
          SECRET_VALUE: ${{ secrets.API_KEY }}
